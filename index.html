<!DOCTYPE html>
<html>
<head>
  <title>POC - Premium</title>
  <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css">
  <link rel="stylesheet" href="styles/premium.css">
  <script src="bower_components/jquery/dist/jquery.js"></script>
  <script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
</head>
<body>
  <div class="container" data-bind="css: { 'demo-mode': demoMode }">
    <div class="row">
      <h3 class="pull-left">2014</h3>
      <button class="btn btn-primary btn-demo" data-bind="click: function () { demoMode(!demoMode()); }">Demo mode</button>
    </div>
    <!-- ko foreach: months -->
    <div class="row month">
      <div class="col-xs-2 month-info">
        <h4 class="pull-left" data-bind="text: name"></h4>
        <div class="month-buttons">
          <div class="dropdown">
            <a class="btn side-button side-main dropdown-toggle" type="button" data-toggle="dropdown">
              +
            </a>
            <ul class="dropdown-menu" role="menu" data-bind="foreach: $root.billingMethods">
              <li role="presentation"><a role="menuitem" tabindex="-1" data-bind="text: name, click: $parent.newCondition.bind($data, $data)"></a></li>
            </ul>
          </div>
          <!-- ko if: conditions().length > 1 -->
          <a class="btn side-button" data-bind="click: summaryCondition.bind($data, 'lower'), css: { 'active': summaryCondition() == 'lower' }">&lt;</a>
          <a class="btn side-button" data-bind="click: summaryCondition.bind($data, 'higher'), css: { 'active': summaryCondition() == 'higher' }">&gt;</a>
          <a class="btn side-button" data-bind="click: summaryCondition.bind($data, 'average'), css: { 'active': summaryCondition() == 'average' }">x&#772;</a>
          <!-- /ko -->
        </div>
      </div>
      <div class="col-xs-10">
        <div data-bind="foreach: conditions">
          <div class="condition" data-bind="css: billingMethod.template">
            <h4 data-bind="text: billingMethod.name"></h4>
            <div class="row month-detail">
              <div class="col-md-6">
                <div class="row">
                  <div class="col-md-6">
                    <select data-bind="value: serviceType, options: $root.serviceTypes, optionsText: 'name', optionsCaption: 'Select a service type'"></select>
                  </div>
                  <div class="col-md-6">
                    <select data-bind="value: product, enable: serviceType, options: (serviceType() && serviceType().products) || [], optionsText: 'name', optionsCaption: serviceType() ? 'Select a product' : 'Select a service type'"></select>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <select class="col-md-6" data-bind="value: invoiceGroup, options: $root.invoiceGroups, optionsText: 'name', optionsCaption: 'Select an invoice group'"></select>
                  </div>
                  <div class="col-md-6">
                    <select class="col-md-6" data-bind="value: subscribersPackage, options: $root.subscribersPackages, optionsText: 'name', optionsCaption: 'Select a package'"></select>
                  </div>
                </div>
                <div class="row" data-bind="visible: billingMethod.isActualSubscribers">
                  <div class="col-md-6">
                    <select class="col-md-6" data-bind="value: priceMethod, options: $root.priceMethods, optionsText: 'name', optionsCaption: 'Select a price method'"></select>
                  </div>
                </div>
              </div>
              <div class="col-md-2">
                <div class="row">
                  <div class="col-md-12">
                    <b class="first-title">Default</b>
                    <div>
                      <input type="number" class="col-md-12" data-bind="value: defaultSubscribers" />
                    </div>
                  </div>
                </div>
             </div>
              <div class="col-md-4" data-bind="template: billingMethod.template"></div>
            </div>
            <button class="btn btn-danger btn-remove" data-bind="click: remove">Remove</button>
          </div>
        </div>
        <div class="row test-subscribers" data-bind="visible: $root.demoMode() && conditions().length">
          <div class="col-md-offset-6 col-md-2">
            <b>Test Subscribers</b>
            <div>
              <input type="number" class="col-md-12" data-bind="value: testSubscribers, valueUpdate: 'afterkeydown'" />
            </div>
          </div>
          <div class="col-md-2">
            <b>Retail Price</b>
            <div class="price">
              <input type="number" class="col-md-12" data-bind="value: testRetailPrice, valueUpdate: 'afterkeydown'" />
            </div>
          </div>
          <div class="col-md-2">
            <div class="test-total">
              <b>Total</b>
              <span data-bind="text: testResult"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- /ko -->
    <div class="row">
      <div class="col-md-offset-11 col-md-1">
        <div class="test-total">
          <b>Total</b>
          <span data-bind="text: testResult"></span>
        </div>
      </div>
    </div>
  </div>
  <script type="text/html" id="flat-fee">
    <div class="row">
      <div class="col-md-offset-5 col-md-6">
        <b class="first-title">Fee</b>
        <div class="price">
          <input type="number" class="col-md-12" data-bind="value: price, valueUpdate: 'afterkeydown'" />
        </div>
      </div>
    </div>
  </script>
  <script type="text/html" id="revenue-share">
    <div class="row">
      <div class="col-md-5">
        <b class="first-title">Up to</b>
      </div>
      <div class="col-md-6">
        <b class="first-title">% Share</b>
      </div>
    </div>
    <!-- ko foreach: ranges -->
    <div class="row" data-bind="css: { 'current-range': $parent.currentRange() === $data }">
      <div class="col-md-5">
        <input type="number" class="col-md-12" data-bind="value: to, event: { blur: $parent.sort }, attr: { placeholder: $last() ? '&infin;' : '' }" />
      </div>
      <div class="col-md-6">
        <input type="number" class="col-md-12" data-bind="value: percentage, valueUpdate: 'afterkeydown'" />
      </div>
      <button class="btn btn-remove-range" data-bind="click: remove, visible: $parent.ranges().length > 1 && !$last()">
        &times;
      </button>
    </div>
    <!-- /ko -->
  </script>
  <script type="text/html" id="actual-subscribers">
    <div class="row">
      <div class="col-md-6">
        <b class="first-title">Up to</b>
      </div>
      <div class="col-md-6">
        <b class="first-title">Price</b>
      </div>
    </div>
    <!-- ko foreach: ranges -->
    <div class="row" data-bind="css: { 'current-range': $parent.currentRange() === $data }">
      <div class="col-md-5">
        <input type="number" class="col-md-12" data-bind="value: to, event: { blur: $parent.sort }, attr: { placeholder: $last() ? '&infin;' : '' }" />
      </div>
      <div class="col-md-6 price">
        <input type="number" class="col-md-12" data-bind="value: price, valueUpdate: 'afterkeydown'" />
      </div>
      <button class="btn btn-remove-range" data-bind="click: remove, visible: $parent.ranges().length > 1">
        &times;
      </button>
    </div>
    <!-- /ko -->
  </script>
  <script src="bundle.js"></script>
  <script>
    var ContractPremium = models.ContractPremium;
    var model = new ContractPremium();

    ko.applyBindings(model);
  </script>
</body>
</html>
